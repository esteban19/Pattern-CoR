C# implementation of Chain of Responsibility